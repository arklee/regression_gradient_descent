from regression import problem

# 目标函数，th为特征值集合，x为自变量集合
def h(th, x):
    return th[1] ** x[0] + th[0]

# 输入矩阵，input[i][j]表示第i+1个训练集的第j+1个自变量
input = [[0.8622192867147255], [3.717578004626198], [4.165939341500806], [3.140285293554567], [1.0234442847354792], [3.115372897233689], [3.078951674209845], [1.9510522171590066], [2.9699003997022126], [0.4359241178786316], [2.1323874888210907], [4.942718645925636], [3.0179568244320176], [4.213608659939082], [4.390862939057934], [0.5256293443335447], [2.5399172020367122], [2.436097610383401], [1.1487406227997683], [1.701531982509303], [0.00233803247625064], [0.4660578659341186], [0.5188993583363205], [2.9757260010348268], [3.984558775083726], [0.7407164615674683], [4.612389086720498], [4.25920469551632], [2.0579628082078516], [1.0597779000373735]]

# 输出向量
output = [1.997072456619737, 13.788703511046965, 17.669225802910997, 9.606538855602246, 2.288531555694187, 8.586877513520042, 8.546142462989458, 3.16382821945956, 8.019578302397981, 0.7496421208100823, 3.928628190916524, 30.986956801126684, 8.534710023609868, 18.362782107338155, 21.262574982405532, 1.1007797832100992, 6.530235403277576, 5.238703818175364, 1.5974329784828247, 2.879696630742869, 0.17490374918897933, 1.9904760740904366, 0.9746566464862705, 7.433822557479555, 16.465949340708292, 2.3564642295532803, 24.396413635341837, 19.27770574991178, 3.8312277905046046, 1.8055328634487584]

# problem(输入矩阵, 输出向量, 目标函数, 迭代次数, 特征值个数)
p = problem(input, output, h, 1000, 2)

# p.plotSets()
p.solve()
p.show()
p.plot()