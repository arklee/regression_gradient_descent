from regression import problem

# 目标函数，th为特征值集合，x为自变量集合
def h(th, x):
    return x[0] * th[2] + x[1] * th[1] + th[0]

# 输入矩阵，input[i][j]表示第i+1个训练集的第j+1个自变量
input = [[0.6434186027035088, -8.936498056584172], [2.9214052149961756, -7.171195265977747], [4.322134090722716, -8.907350527752447], [2.550502112037656, -7.451176516446642], [1.5975390750843195, -6.8119630946524925], [4.718222911967612, -8.28864085034295], [2.817155190584713, -9.613583380168043], [2.9844694604123445, -4.997822620092901], [1.3685076713398903, -1.9929528883325065], [2.351178859337386, -7.132440164639058], [3.7087663746877304, -4.621548511954844], [1.2662920573219982, -4.718919001178915], [0.04059510463279237, -3.594657615666722], [2.8749475238773234, -6.3185962585999835], [2.2799980908577244, -2.760606759295193], [4.412291540338426, -2.2893974680800278], [1.8029348552553037, -8.162330548857708], [4.198834472964524, -8.764278141414085], [2.17752060303202, -6.692625893133838], [0.8280908185552882, -1.5684245166254784], [0.3370007749596443, -4.996911968202954], [3.1444790593515206, -9.806431393061763], [2.5251910993710096, -6.767478937776334], [4.562901617306717, -0.08333466377850818], [4.254249217733113, -6.582114640522377], [4.49630336332895, -3.4491079216535523], [0.5298976224538415, -5.971051702680279], [0.7336502734563088, -0.049798672837236824], [2.163056330217766, -0.7712082147410804], [1.3361580523124927, -8.91842924056642]]

# 输出向量
output = [-63.74919491731911, -39.091301627971475, -44.47554918260902, -42.62872726757548, -43.803908982149274, -38.7853450384015, -56.30397158424413, -27.994566710963547, -17.4359747645412, -41.53671624093881, -20.342961018984962, -36.080707000657874, -31.72289620618298, -37.27608710916654, -15.375739295204182, -2.2684749928712535, -50.64491418266921, -42.363237637620955, -42.0546234842678, -18.201439365922898, -39.901030089378416, -55.22018751990524, -38.37832422303737, 8.823373383178087, -31.41182091096436, -8.76772213081913, -47.33137253699469, -11.466817998664322, -4.551772227729902, -58.78708175220281]

# problem(输入矩阵, 输出向量, 目标函数, 迭代次数, 特征值个数)
p = problem(input, output, h, 1000, 3)

# p.plotSets()
p.solve()
p.show()
p.plot()