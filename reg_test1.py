from regression import problem

# 目标函数，th为特征值集合，x为自变量集合
def h(th, x):
    return th[1] * x[0] + th[0]

# 输入矩阵，input[i][j]表示第i+1个训练集的第j+1个自变量
input = [[3.3010625532186455], [0.7281389198429228], [3.684066904439801], [4.974629555580322], [0.7672919271043754], [0.7868113708325225], [0.004655336593707982], [1.680340091158667], [4.766353909866303], [4.2556485746099755], [3.790961046104797], [2.2132095309510125], [3.853795247776592], [1.2823664529455363], [3.7280326247123026], [3.7551608500140707], [2.2158842794333484], [1.8492006249577753], [0.12318648954932343], [0.969102149616603], [3.7309655534946797], [2.2359598901707374], [3.772052975385096], [1.1608151584429927], [4.584387950170878], [4.161994213721104], [4.7006820460250935], [2.4600504138220836], [2.7362220736098726], [1.8076853275502884]]

# 输出向量
output = [-3.981349311365694, 0.6197753767449063, -5.065317546387463, -7.45825992944757, 1.127096565924374, 1.1443287897487253, 2.6060499053106265, -1.003958949727759, -6.988855414820345, -5.819045108311868, -5.377592428181328, -2.1577843145166713, -5.360720072279845, 0.1317438306609484, -4.754352234617715, -5.076462457142702, -2.3962041160809733, -1.4156631241209143, 2.321613366124361, 0.8550329198698701, -5.2078864982049655, -1.7169235269549934, -4.857379638320477, -0.011592573700128006, -7.002758057696201, -5.7816819155447625, -6.954971029795958, -2.4112357280334673, -3.057000884109576, -1.382008085249078]

# problem(输入矩阵, 输出向量, 目标函数, 迭代次数, 特征值个数)
p = problem(input, output, h, 500, 2)

# p.plotSets()
p.solve()
p.show()
p.plot()